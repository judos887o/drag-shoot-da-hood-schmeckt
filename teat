local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local Shared = getgenv().SchmecktHubPC or {}
getgenv().SchmecktHubPC = Shared

if Shared.DragShoot == nil then Shared.DragShoot = true end

local key = "DragShoot"

-- Connections bereinigen
Shared.Connections = Shared.Connections or {}
if Shared.Connections[key] then 
    for _, c in pairs(Shared.Connections[key]) do pcall(function() c:Disconnect() end) end
end
Shared.Connections[key] = {}

local holding = false
local LP = Players.LocalPlayer

table.insert(Shared.Connections[key], UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if not Shared.DragShoot then return end
    
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        holding = true
        task.spawn(function()
            while holding and Shared.DragShoot do
                local char = LP.Character
                if char then
                    local tool = char:FindFirstChildOfClass("Tool")
                    if tool then
                        tool:Activate()
                        task.wait()
                        tool:Deactivate()
                    end
                end
                
                task.wait(0.05) 
            end
        end)
    end
end))

table.insert(Shared.Connections[key], UserInputService.InputEnded:Connect(function(input, gp)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        holding = false
    end
end))
